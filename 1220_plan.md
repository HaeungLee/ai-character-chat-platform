# 2024-12-20 AI Character Platform Expansion Master Plan

## 1. Vision & Objectives
To build a "Complete" AI Character Chat platform comparable to **Character.AI** or **Zeta**, featuring deep roleplay capabilities, immersive UI, and comprehensive character creation tools.

## 2. Technical Stack Strategy
- **LLM Provider**: OpenRouter (Unified billing, access to Mythomax, Llama 3, etc.)
- **Image Generation**: Stable Diffusion (via OpenRouter or Replicate API recommended for scalability)
- **Frontend**: Next.js 14+ (App Router), TailwindCSS, Framer Motion
- **Backend**: Node.js/Express (Existing), Prisma ORM, PostgreSQL

## 3. Core Features Roadmap

### Phase 1: The Foundation (Immediate Scope)
* **Exploration Feed**:
    *   Masonry Grid layout for characters.
    *   Search & Filter (Tag-based).
* **Advanced Character Creation (Wizard)**:
    *   **Identity**: Name, Avatar, Description.
    *   **Image Gen**: Text-to-Image prompt input -> Generate Avatar.
    *   **Personality**: System Prompt, Greeting Message.
    *   **Few-Shot Examples**: UI for defining "User: ... / Char: ..." dialogue examples (Critical for style).
    *   **Lorebook (New)**: "World Info" management. Define keywords that trigger specific background info.
* **Immersive Chat Interface**:
    *   **Bubbles**: "WhatsApp/Messenger" style but cleaner.
    *   **Controls**:
        *   **Regenerate**: Swipe or click to get a new response.
        *   **Edit**: User can edit AI's last message (essential for steering RP).
    *   **Background**: Dynamic wallpapers per character.

### Phase 2: Engagement & Depth (Follow-up)
*   **Voice (TTS)**: Integration with ElevenLabs or edge-tts.
*   **Memory Systems**: Visualizing the Vector DB / Summary status.
*   **Persona Profile**: User defines "Who I am" for the chat context.
*   **Social**: Comments, Likes, "Remix Character".

## 4. Database Schema Changes Required

### New Model: `LorebookEntry` (or `WorldInfo`)
To support the "Universe/Settings" feature.
```prisma
model LorebookEntry {
  id          String   @id @default(cuid())
  characterId String
  character   Character @relation(fields: [characterId], references: [id], onDelete: Cascade)
  
  keys        String[] // Trigger keyphrases (e.g. "Excalibur", "Magic School")
  content     String   // The text injected when triggered
  
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([characterId])
}
```

### Updates to `Character`
*   Add relation to `LorebookEntry`.
*   Add `exampleDialogues` field (Json or separate model).

## 5. Image Generation Strategy
**Recommendation**: Use **Stable Diffusion XL (SDXL)** or **Flux** via API.
*   **Why API?**: Running SD locally requires heavy GPU resources. For a web app serving users, an API (Serverless GPU) is best.
*   **Path**: 
    1.  Use **OpenRouter** if they offer image models (they recently added some).
    2.  Alternatively, use **Replicate** (standard for hosting SD models).
    *   User inputs prompt -> App calls API -> Returns Image URL -> Save to Cloudinary/S3 -> Link to Character.

## 6. Next Steps
1.  **Schema Migration**: Update `schema.prisma`.
2.  **Backend Logic**: Create CRUD endpoints for Lorebooks.
3.  **Frontend Layout**: detailed implementation of the Creation Wizard.
